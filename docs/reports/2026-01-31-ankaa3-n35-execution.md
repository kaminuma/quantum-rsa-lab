# Shor's Algorithm N=35 実機実行レポート

**実行日時**: 2026年1月31日 02:52 JST
**実行者**: quantum-crypto-lab
**デバイス**: Rigetti Ankaa-3 (AWS Braket)

---

## 概要

Shorのアルゴリズムの簡約回路を使用して、**N=35 (= 5 × 7)** の因数分解を実際の量子コンピュータで実行し、**統計的に有意な量子信号を検出**した。

### 本実験の位置づけ

本実験は以下を実証するものである：

1. **NISQ実機におけるShor簡約回路の信号可観測性**
2. **回路最小化が位相情報保存に寄与すること**
3. **基数選択による量子リソース削減の有効性**

⚠️ **注意**: 本実験は「RSAを破った」「Shorを完全に成功させた」ことを主張するものではない。

---

## 実行環境

| 項目 | 値 |
|------|-----|
| デバイス | Rigetti Ankaa-3 |
| デバイスタイプ | 超伝導量子コンピュータ |
| 量子ビット数（デバイス） | 84 |
| 使用量子ビット数 | **3** |
| リージョン | us-west-1 (北カリフォルニア) |
| プラットフォーム | AWS Braket |

---

## 回路仕様

| 項目 | 値 |
|------|-----|
| 対象数 N | 35 (= 5 × 7) |
| 基数 a | **6** |
| 周期 r | **2** |
| 量子ビット構成 | 制御: 2, 作業: 1 |
| 2Qゲート数 | **2** |
| 回路深度 | **7** |
| ショット数 | 1000 |

### 理論的背景

```
ord_35(6) = 2  （∵ 6² = 36 ≡ 1 mod 35）

状態マッピング:
  |1⟩ → |0⟩
  |6⟩ → |1⟩

制御ユニタリ:
  U^1 = X gate (CNOT)
  U^2 = Identity (周期2で元に戻る)
```

### 回路図

```
T  : │  0  │  1  │   2    │  3  │       4        │  5  │
      ┌───┐                ┌───┐ ┌──────────────┐
q0 : ─┤ H ├───●──────x─────┤ H ├─┤ PHASE(-1.57) ├───────
      └───┘   │      │     └───┘ └──────┬───────┘
      ┌───┐   │      │                  │         ┌───┐
q1 : ─┤ H ├───┼──────x──────────────────●─────────┤ H ├─
      └───┘   │                                   └───┘
            ┌─┴─┐
q2 : ───────┤ X ├───────────────────────────────────────
            └───┘
```

---

## 実行結果

### 測定結果（生データ）

| 測定値 (q2q1q0) | 回数 | 確率 | 制御部 (q1q0) | 位相 |
|-----------------|------|------|---------------|------|
| 000 | 269 | 26.9% | 00 | 0.000 |
| 010 | 254 | 25.4% | 10 | 0.500 |
| 001 | 252 | 25.2% | 01 | 0.250 |
| 011 | 193 | 19.3% | 11 | 0.750 |
| 110 | 14 | 1.4% | 10 | 0.500 |
| 100 | 7 | 0.7% | 00 | 0.000 |
| 111 | 6 | 0.6% | 11 | 0.750 |
| 101 | 5 | 0.5% | 01 | 0.250 |

### 制御レジスタ集計

| 制御部 | 回数 | 確率 | 位相 | 理論値 |
|--------|------|------|------|--------|
| 00 | 276 | **27.6%** | 0.000 | 50% |
| 10 | 268 | **26.8%** | 0.500 | 50% |
| 01 | 257 | 25.7% | 0.250 | 0% |
| 11 | 199 | 19.9% | 0.750 | 0% |

---

## 統計分析

### カイ二乗検定

帰無仮説 H₀: 測定結果は一様分布（量子信号なし）

| 項目 | 値 |
|------|-----|
| カイ二乗値 | 14.60 |
| p値 | **0.00219** |
| 判定 | **p < 0.01: 統計的に有意** |

**解釈**: 「量子回路が何かをしている」ことは統計的に示された。一様分布（完全ランダム）仮説は明確に棄却される。

### 成功率分析

| 指標 | 値 | 評価 |
|------|-----|------|
| 正しい位相 (0.0 + 0.5) の確率 | **54.4%** | 期待位相が優勢 |
| ノイズ位相 (0.25 + 0.75) の確率 | 45.6% | 依然として大きい |

### 正直な評価

⚠️ **重要な注意点**:

- 理想的なShor成功は P(correct) ≫ P(other) であるべき
- 今回の結果は「期待位相が優勢」だが「支配的」ではない
- 54% vs 46% は「ほぼコイン投げに近い」状態
- 「周期情報が完全に抽出できた」とは言えない
- より正確には「周期 r=2 が偶然引ける確率がやや高い状態」

---

## N=21 との比較

| 項目 | N=21 (2026-01-30) | N=35 (今回) |
|------|-------------------|-------------|
| 対象数 | 21 = 3 × 7 | **35 = 5 × 7** |
| 基数 a | 4 | **6** |
| 周期 r | 3 | **2** |
| 量子ビット数 | 5 | **3** |
| 2Qゲート数 | 15 | **2** |
| 期待位相検出率 | ~20% | **54.4%** |
| 回路深度 | 31 | **7** |

**解釈**: 量子資源削減（量子ビット数、2Qゲート数、回路深度）が信号保存に寄与することを示唆。これはNISQ時代の量子計算において重要な知見。

---

## 因数分解の導出

### 数学的処理（正しい）

測定された位相 0.500 から：

```
位相 = 0.500 = 1/2
→ 連分数展開: 1/2
→ 分母 = 周期 r = 2

a = 6, r = 2, N = 35

a^(r/2) = 6^1 = 6

gcd(6 - 1, 35) = gcd(5, 35) = 5  ✓
gcd(6 + 1, 35) = gcd(7, 35) = 7  ✓

∴ 35 = 5 × 7
```

### 量子計算としての評価（注意が必要）

⚠️ **r=2 は最も「古典に近い」周期**:
- Shorの難しさは r が大きい場合の周期検出
- r=2 は最小の非自明な周期
- 本実験は「Shorの完全実装」ではなく「Shorの周期検出コアを実機で観測した」と表現するのが正確

---

## 限界と今後の課題

### 本実験の限界

1. **ショット数が少ない** (1000): 統計的信頼性向上には 10,000+ が望ましい
2. **単一基数のみ**: a=6 以外の基数での比較実験が必要
3. **r=2 は最小周期**: より大きな周期での検証が必要
4. **ノイズモデルとの比較なし**: 古典シミュレータ+ノイズモデルとの一致度検証が必要

### 今後の実験計画

1. ショット数を 10,000 以上に増加
2. 複数の基数 (a=4, 6, 8) での成功率分布を取得
3. 位相ビット数を 2→3 に増やして比較
4. Hellinger distance / KL divergence で理論分布との比較
5. Qiskit Aer のノイズモデルとの一致度検証

---

## 結論

### 何を示せたか

1. **統計的に有意な量子信号を検出** (p = 0.00219 < 0.01)
2. **回路最小化が信号保存に寄与** (N=21 の ~20% → N=35 の 54.4%)
3. **基数選択による量子リソース削減の有効性**

### 何を示していないか

1. ❌「RSAが破れた」
2. ❌「Shorを完全に成功させた」
3. ❌「周期情報を完全に抽出した」

### 正確な位置づけ

> **「NISQ実機におけるShor簡約回路の信号可観測性を実証し、回路最小化が位相情報保存に寄与することを示した」**

### 学術的意義

- 「Nを大きくする」のではなく「信号が壊れない構造を探す」アプローチ
- これはNISQ時代において正しい研究方向性
- 我々の知る限り、AWS Braket Ankaa-3 上での N=35 最小回路 (3量子ビット) 実証例

---

## 生データ

```json
{
  "task_id": "arn:aws:braket:us-west-1:XXXXXXXXXXXX:quantum-task/XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",
  "timestamp": "2026-01-31T02:52:30.809124",
  "parameters": {
    "N": 35,
    "a": 6,
    "r": 2,
    "n_qubits": 3,
    "shots": 1000
  },
  "raw_counts": {
    "010": 254,
    "001": 252,
    "000": 269,
    "011": 193,
    "101": 5,
    "110": 14,
    "111": 6,
    "100": 7
  }
}
```

---

## 参考文献

1. P. W. Shor, "Algorithms for quantum computation: discrete logarithms and factoring," FOCS 1994
2. E. Pelofske et al., "Practical Challenges in Executing Shor's Algorithm on Existing Quantum Platforms," arXiv:2512.15330, 2024
3. U. Skosana and M. Tame, "Demonstration of Shor's factoring algorithm for N = 21 on IBM quantum processors," Scientific Reports 11, 16599 (2021)
4. J. A. Smolin, G. Smith, and A. Vargo, "Oversimplifying quantum factoring," Nature 499, 163-165 (2013)

---

*Generated by quantum-crypto-lab*
*Last updated: 2026-01-31*
